# Deploying BookShare to Render

## Prerequisites
- GitHub account with the BookShare repository
- Render account (free tier works fine)

## Deployment Steps

### 1. Create a Render Account
1. Go to [render.com](https://render.com)
2. Sign up with your GitHub account

### 2. Create a New Web Service

#### Option A: Using render.yaml (Recommended - Automated)
1. In Render Dashboard, click **"New +"** → **"Blueprint"**
2. Connect your GitHub repository: `Book-Share-App`
3. Render will automatically detect `render.yaml` and configure everything
4. Click **"Apply"** to create the service

#### Option B: Manual Setup
1. In Render Dashboard, click **"New +"** → **"Web Service"**
2. Connect your GitHub repository: `Book-Share-App`
3. Configure the service:
   - **Name**: `bookshare` (or your preferred name)
   - **Region**: Choose closest to you
   - **Branch**: `main`
   - **Runtime**: `Python 3`
   - **Build Command**: `chmod +x build.sh && ./build.sh`
   - **Start Command**: `gunicorn run:app`
   - **Instance Type**: `Free`

### 3. Set Environment Variables

Add these in the Render dashboard under "Environment":

```
FLASK_ENV=production
SECRET_KEY=[Auto-generated by Render]
PYTHON_VERSION=3.11.0
```

**Optional Email Settings** (for loan reminders):
```
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=True
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=BookShare <noreply@bookshare.com>
```

### 4. Deploy

1. Click **"Create Web Service"**
2. Wait for the build and deployment (5-10 minutes)
3. Your app will be live at: `https://bookshare-xxxx.onrender.com`

## Post-Deployment

### Access Your App
- URL format: `https://your-service-name.onrender.com`
- Example: `https://bookshare.onrender.com`

### Verify Deployment
1. Visit the URL
2. You should see the BookShare dashboard
3. Sample data will be pre-loaded (100 books, 20 borrowers, 30 loans)
4. AI recommendations should work immediately

### Database
- Render automatically provisions a PostgreSQL database
- Data persists across deployments
- SQLite is replaced with PostgreSQL in production

### Monitoring
- View logs in Render dashboard under "Logs"
- Monitor performance under "Metrics"
- Set up health checks if needed

## Troubleshooting

### Build Fails
- Check build logs in Render dashboard
- Verify all dependencies in `requirements.txt` are compatible
- Ensure `build.sh` has execute permissions

### App Crashes on Start
- Check application logs
- Verify environment variables are set
- Check that `gunicorn` is in requirements.txt

### Database Connection Issues
- Verify `DATABASE_URL` environment variable is set
- Check that database is created and accessible

### Recommendation System Not Working
- Run `flask rebuild-recs` from Render shell
- Check logs for any build errors during cache creation

## Updating Your App

### Push Updates
```bash
git add .
git commit -m "Update message"
git push origin main
```

Render will automatically:
1. Detect the push
2. Pull latest code
3. Run build script
4. Deploy updates
5. Zero-downtime deployment

### Manual Deploy
- In Render dashboard, click "Manual Deploy" → "Deploy latest commit"

## Custom Domain (Optional)

1. In Render dashboard, go to "Settings"
2. Scroll to "Custom Domain"
3. Add your domain (e.g., `bookshare.yourdomain.com`)
4. Follow DNS configuration instructions

## Performance Notes

### Free Tier Limitations
- Service spins down after 15 minutes of inactivity
- First request after spin-down takes 30-60 seconds
- 750 hours/month free (enough for one service)

### Upgrade Options
- **Starter ($7/month)**: No spin-down, better performance
- **Standard ($25/month)**: More resources, faster builds

## Email Reminders Setup

For production email reminders:

1. Use Gmail with App Password:
   - Enable 2FA on your Google account
   - Generate an App Password
   - Use it as `SMTP_PASSWORD`

2. Or use SendGrid (recommended):
   - Create free SendGrid account
   - Get API key
   - Configure SMTP settings

## Monitoring & Maintenance

### Check Health
- Monitor "Events" tab for deployment history
- Review "Metrics" for performance
- Set up alerts for downtime

### Database Backups
- Render automatically backs up PostgreSQL databases
- Manual exports available in dashboard

### Logs
- Real-time logs available in dashboard
- Filter by severity level
- Download for analysis

## Support

- Render Docs: [render.com/docs](https://render.com/docs)
- Community: [community.render.com](https://community.render.com)
- App-specific issues: Check application logs

## Success Checklist

- [ ] Service deployed successfully
- [ ] Homepage loads
- [ ] Sample data visible
- [ ] Can create/view books
- [ ] AI recommendations working
- [ ] (Optional) Email reminders configured
- [ ] Custom domain set up (if applicable)
